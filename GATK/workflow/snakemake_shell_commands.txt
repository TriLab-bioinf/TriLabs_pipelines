module load bwa-mem2/2.2.1 samtools/1.21
----------------------
bwa-mem2 mem data/bwadb//genome.fa         results/1-trim/NA19913_ERR250256.P.R1.fastq.gz results/1-trim/NA19913_ERR250256.P.R2.fastq.gz        
  -t 1        
  -R '@RG\tID:NA19913_ERR250256\tSM:NA19913_ERR250256\tPL:ILLUMINA'         | samtools sort
  -@ 1
  -O BAM
  -o results/2-map_reads/NA19913_ERR250256.bam
  -
----------------------
samtools index
  -@ 1 results/2-map_reads/NA19913_ERR250256.bam
----------------------
module load bwa-mem2/2.2.1 samtools/1.21
----------------------
bwa-mem2 mem data/bwadb//genome.fa         results/1-trim/NA19913_ERR250967.P.R1.fastq.gz results/1-trim/NA19913_ERR250967.P.R2.fastq.gz        
  -t 1        
  -R '@RG\tID:NA19913_ERR250967\tSM:NA19913_ERR250967\tPL:ILLUMINA'         | samtools sort
  -@ 1
  -O BAM
  -o results/2-map_reads/NA19913_ERR250967.bam
  -
----------------------
samtools index
  -@ 1 results/2-map_reads/NA19913_ERR250967.bam
----------------------
module load bwa-mem2/2.2.1 samtools/1.21
----------------------
bwa-mem2 mem data/bwadb//genome.fa         results/1-trim/NA20274_ERR250968.P.R1.fastq.gz results/1-trim/NA20274_ERR250968.P.R2.fastq.gz        
  -t 1        
  -R '@RG\tID:NA20274_ERR250968\tSM:NA20274_ERR250968\tPL:ILLUMINA'         | samtools sort
  -@ 1
  -O BAM
  -o results/2-map_reads/NA20274_ERR250968.bam
  -
----------------------
samtools index
  -@ 1 results/2-map_reads/NA20274_ERR250968.bam
----------------------
module load bwa-mem2/2.2.1 samtools/1.21
----------------------
bwa-mem2 mem data/bwadb//genome.fa         results/1-trim/NA20274_ERR250969.P.R1.fastq.gz results/1-trim/NA20274_ERR250969.P.R2.fastq.gz        
  -t 1        
  -R '@RG\tID:NA20274_ERR250969\tSM:NA20274_ERR250969\tPL:ILLUMINA'         | samtools sort
  -@ 1
  -O BAM
  -o results/2-map_reads/NA20274_ERR250969.bam
  -
----------------------
samtools index
  -@ 1 results/2-map_reads/NA20274_ERR250969.bam
----------------------
module load GATK/4.6.0.0
----------------------
gatk MarkDuplicates         
  -I results/2-map_reads/NA20274_ERR250968.bam         
  -O results/3-dedup/NA20274_ERR250968.dedup.bam         
  -M results/3-dedup/NA20274_ERR250968.metrics.txt         
  --CREATE_INDEX true         
  --TMP_DIR results/3-dedup/NA20274_ERR250968.tmp > logs/3-dedup/NA20274_ERR250968.dedup.log 2>&1
----------------------
module load GATK/4.6.0.0
----------------------
gatk MarkDuplicates         
  -I results/2-map_reads/NA19913_ERR250967.bam         
  -O results/3-dedup/NA19913_ERR250967.dedup.bam         
  -M results/3-dedup/NA19913_ERR250967.metrics.txt         
  --CREATE_INDEX true         
  --TMP_DIR results/3-dedup/NA19913_ERR250967.tmp > logs/3-dedup/NA19913_ERR250967.dedup.log 2>&1
----------------------
module load GATK/4.6.0.0
----------------------
gatk MarkDuplicates         
  -I results/2-map_reads/NA20274_ERR250969.bam         
  -O results/3-dedup/NA20274_ERR250969.dedup.bam         
  -M results/3-dedup/NA20274_ERR250969.metrics.txt         
  --CREATE_INDEX true         
  --TMP_DIR results/3-dedup/NA20274_ERR250969.tmp > logs/3-dedup/NA20274_ERR250969.dedup.log 2>&1
----------------------
module load GATK/4.6.0.0
----------------------
gatk MarkDuplicates         
  -I results/2-map_reads/NA19913_ERR250256.bam         
  -O results/3-dedup/NA19913_ERR250256.dedup.bam         
  -M results/3-dedup/NA19913_ERR250256.metrics.txt         
  --CREATE_INDEX true         
  --TMP_DIR results/3-dedup/NA19913_ERR250256.tmp > logs/3-dedup/NA19913_ERR250256.dedup.log 2>&1
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms4G
  -Xmx4G
  -XX:ParallelGCThreads=4" BaseRecalibrator      
  -I results/3-dedup/NA20274_ERR250969.dedup.bam      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  --known-sites /fdb/GATK_resource_bundle/hg38/dbsnp_146.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/1000G_phase1.snps.high_confidence.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/1000G_omni2.5.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/hapmap_3.3.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.known_indels.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz      
  -O results/4-bqsr/NA20274_ERR250969.recal_data.table
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms4G
  -Xmx4G
  -XX:ParallelGCThreads=4" BaseRecalibrator      
  -I results/3-dedup/NA19913_ERR250967.dedup.bam      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  --known-sites /fdb/GATK_resource_bundle/hg38/dbsnp_146.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/1000G_phase1.snps.high_confidence.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/1000G_omni2.5.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/hapmap_3.3.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.known_indels.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz      
  -O results/4-bqsr/NA19913_ERR250967.recal_data.table
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms4G
  -Xmx4G
  -XX:ParallelGCThreads=4" BaseRecalibrator      
  -I results/3-dedup/NA20274_ERR250968.dedup.bam      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  --known-sites /fdb/GATK_resource_bundle/hg38/dbsnp_146.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/1000G_phase1.snps.high_confidence.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/1000G_omni2.5.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/hapmap_3.3.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.known_indels.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz      
  -O results/4-bqsr/NA20274_ERR250968.recal_data.table
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms4G
  -Xmx4G
  -XX:ParallelGCThreads=4" BaseRecalibrator      
  -I results/3-dedup/NA19913_ERR250256.dedup.bam      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  --known-sites /fdb/GATK_resource_bundle/hg38/dbsnp_146.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/1000G_phase1.snps.high_confidence.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/1000G_omni2.5.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/hapmap_3.3.hg38.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.known_indels.vcf.gz
  --known-sites /fdb/GATK_resource_bundle/hg38/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz      
  -O results/4-bqsr/NA19913_ERR250256.recal_data.table
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms2G
  -Xmx2G
  -XX:ParallelGCThreads=4" ApplyBQSR      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  -I results/3-dedup/NA20274_ERR250968.dedup.bam      
  --bqsr-recal-file results/4-bqsr/NA20274_ERR250968.recal_data.table      
  -O results/4-bqsr/NA20274_ERR250968.recal.bam
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms2G
  -Xmx2G
  -XX:ParallelGCThreads=4" ApplyBQSR      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  -I results/3-dedup/NA19913_ERR250967.dedup.bam      
  --bqsr-recal-file results/4-bqsr/NA19913_ERR250967.recal_data.table      
  -O results/4-bqsr/NA19913_ERR250967.recal.bam
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms2G
  -Xmx2G
  -XX:ParallelGCThreads=4" ApplyBQSR      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  -I results/3-dedup/NA19913_ERR250256.dedup.bam      
  --bqsr-recal-file results/4-bqsr/NA19913_ERR250256.recal_data.table      
  -O results/4-bqsr/NA19913_ERR250256.recal.bam
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms2G
  -Xmx2G
  -XX:ParallelGCThreads=4" ApplyBQSR      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  -I results/3-dedup/NA20274_ERR250969.dedup.bam      
  --bqsr-recal-file results/4-bqsr/NA20274_ERR250969.recal_data.table      
  -O results/4-bqsr/NA20274_ERR250969.recal.bam
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms16G
  -Xmx16G
  -XX:ParallelGCThreads=8" HaplotypeCaller      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  -I results/4-bqsr/NA20274_ERR250969.recal.bam      
  -O results/5-vcf/NA20274_ERR250969.raw.g.vcf.gz      
  -ERC GVCF > logs/5-vcf/NA20274_ERR250969.haplotype_caller.log 2>&1
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms16G
  -Xmx16G
  -XX:ParallelGCThreads=8" HaplotypeCaller      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  -I results/4-bqsr/NA19913_ERR250967.recal.bam      
  -O results/5-vcf/NA19913_ERR250967.raw.g.vcf.gz      
  -ERC GVCF > logs/5-vcf/NA19913_ERR250967.haplotype_caller.log 2>&1
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms16G
  -Xmx16G
  -XX:ParallelGCThreads=8" HaplotypeCaller      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  -I results/4-bqsr/NA20274_ERR250968.recal.bam      
  -O results/5-vcf/NA20274_ERR250968.raw.g.vcf.gz      
  -ERC GVCF > logs/5-vcf/NA20274_ERR250968.haplotype_caller.log 2>&1
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms16G
  -Xmx16G
  -XX:ParallelGCThreads=8" HaplotypeCaller      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  -I results/4-bqsr/NA19913_ERR250256.recal.bam      
  -O results/5-vcf/NA19913_ERR250256.raw.g.vcf.gz      
  -ERC GVCF > logs/5-vcf/NA19913_ERR250256.haplotype_caller.log 2>&1
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms8G
  -Xmx8G
  -XX:ParallelGCThreads=8" CombineGVCFs      
  -V results/5-vcf/NA19913_ERR250256.raw.g.vcf.gz
  -V results/5-vcf/NA19913_ERR250967.raw.g.vcf.gz
  -V results/5-vcf/NA20274_ERR250968.raw.g.vcf.gz
  -V results/5-vcf/NA20274_ERR250969.raw.g.vcf.gz      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  -O results/6-merged/all.wgs.g.vcf.gz
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms8G
  -Xmx8G
  -XX:ParallelGCThreads=8" GenotypeGVCFs      
  -V results/6-merged/all.wgs.g.vcf.gz      
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta      
  -O results/6-merged/all.wgs.combined.vcf.gz
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms4G
  -Xmx4G
  -XX:ParallelGCThreads=8" VariantRecalibrator          
  -tranche 100.0
  -tranche 99.95
  -tranche 99.9          
  -tranche 99.5
  -tranche 99.0
  -tranche 97.0
  -tranche 96.0          
  -tranche 95.0
  -tranche 94.0          
  -tranche 93.5
  -tranche 93.0
  -tranche 92.0
  -tranche 91.0
  -tranche 90.0          
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta          
  -V results/6-merged/all.wgs.combined.vcf.gz          
  --resource:hapmap,known=false,training=true,truth=true,prior=15.0           /fdb/GATK_resource_bundle/hg38/hapmap_3.3.hg38.vcf.gz           
  --resource:omni,known=false,training=true,truth=false,prior=12.0           /fdb/GATK_resource_bundle/hg38/1000G_omni2.5.hg38.vcf.gz          
  --resource:1000G,known=false,training=true,truth=false,prior=10.0           /fdb/GATK_resource_bundle/hg38/1000G_phase1.snps.high_confidence.hg38.vcf.gz          
  -resource:dbsnp,known=false,training=true,truth=false,prior=10.0           /fdb/GATK_resource_bundle/hg38/dbsnp_146.hg38.vcf.gz          
  -an QD
  -an MQ
  -an MQRankSum
  -an ReadPosRankSum
  -an FS
  -an SOR          
  -mode SNP
  -O results/7-filtered_vcf/all.wgs.SNP.recal
  --tranches-file results/7-filtered_vcf/all.wgs.SNP.tranches          
  --rscript-file results/7-filtered_vcf/all.wgs.SNP.plots.R > logs/7-filtered_vcf/all.wgs.VariantRecalibrator.log 2>&1
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms4G
  -Xmx4G
  -XX:ParallelGCThreads=8" VariantRecalibrator          
  -tranche 100.0
  -tranche 99.95
  -tranche 99.9          
  -tranche 99.5
  -tranche 99.0
  -tranche 97.0
  -tranche 96.0          
  -tranche 95.0
  -tranche 94.0
  -tranche 93.5
  -tranche 93.0          
  -tranche 92.0
  -tranche 91.0
  -tranche 90.0          
  -R /fdb/GATK_resource_bundle/hg38/Homo_sapiens_assembly38.fasta          
  -V results/6-merged/all.wgs.combined.vcf.gz          
  --resource:mills,known=false,training=true,truth=true,prior=12.0           /fdb/GATK_resource_bundle/hg38/Mills_and_1000G_gold_standard.indels.hg38.vcf.gz          
  --resource:dbsnp,known=true,training=false,truth=false,prior=2.0           /fdb/GATK_resource_bundle/hg38/dbsnp_146.hg38.vcf.gz          
  -an QD
  -an MQRankSum
  -an ReadPosRankSum
  -an FS
  -an SOR
  -an DP          
  -mode INDEL
  -O results/7-filtered_vcf/all.wgs.indel.recal
  --tranches-file results/7-filtered_vcf/all.wgs.indel.tranches          
  --rscript-file results/7-filtered_vcf/all.wgs.indel.plots.R >> logs/7-filtered_vcf/all.wgs.VariantRecalibrator.log 2>&1
----------------------
module load GATK/4.6.0.0
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms2G
  -Xmx2G
  -XX:ParallelGCThreads=8" ApplyVQSR          
  -V results/6-merged/all.wgs.combined.vcf.gz          
  --recal-file results/7-filtered_vcf/all.wgs.SNP.recal          
  -mode SNP          
  --tranches-file results/7-filtered_vcf/all.wgs.SNP.tranches          
  --truth-sensitivity-filter-level 99.9          
  --create-output-variant-index true          
  -O results/7-filtered_vcf/all.wgs.SNP.recalibrated_99.9.vcf.gz > logs/7-filtered_vcf/all.wgs.apply_vqsr.log 2>&1
----------------------
gatk
  --java-options "-Djava.io.tmpdir=/lscratch/$SLURM_JOBID
  -Xms2G
  -Xmx2G
  -XX:ParallelGCThreads=2" ApplyVQSR          
  -V results/7-filtered_vcf/all.wgs.SNP.recalibrated_99.9.vcf.gz          
  -mode INDEL          
  --recal-file results/7-filtered_vcf/all.wgs.indel.recal          
  --tranches-file results/7-filtered_vcf/all.wgs.indel.tranches          
  --truth-sensitivity-filter-level 99.9          
  --create-output-variant-index true          
  -O results/7-filtered_vcf/all.wgs.indel.SNP.recalibrated_99.9.vcf.gz >> logs/7-filtered_vcf/all.wgs.apply_vqsr.log 2>&1
----------------------
